"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7416],{7416:(w,u,r)=>{r.r(u),r.d(u,{TrivialPageModule:()=>M});var l=r(6814),f=r(95),s=r(451),h=r(2692),d=r(5861),t=r(9212),p=r(8540);let m=(()=>{class a{constructor(e,i){this.firestore=e,this.datePipe=i,this.formatoFecha="dd/MM/yyyy"}getPreguntas(e){return this.firestore.collection("trivialPreguntas").doc("bateriaPreguntas").collection(e).valueChanges()}addTirada(e){console.log("tiradita;",e);const i=this.datePipe.transform(new Date,this.formatoFecha)?.replace(/\//g,"");return this.firestore.collection("tiradas").doc(e.idJugador.toString()).collection(i).add({idPregunta:e.idPregunta,respuesta:e.respuesta,esCorrecta:e.esCorrecta})}getJugada(e,i){return this.firestore.collection("tiradas").doc(e).collection(i.replace(/\//g,"")).valueChanges()}static#t=this.\u0275fac=function(i){return new(i||a)(t.LFG(p.ST),t.LFG(l.uU))};static#e=this.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();var v=r(2333),C=r(5232),T=r(6065),y=r(7898);function P(a,g){if(1&a){const e=t.EpF();t.TgZ(0,"ion-col",14)(1,"ion-card",15)(2,"ion-card-header")(3,"ion-card-title",16),t.NdJ("click",function(){const n=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.responder(n))}),t._uU(4),t.qZA()()()()}if(2&a){const e=g.$implicit,i=t.oxw(2);t.xp6(),t.s9C("color",i.colorCategoria),t.xp6(3),t.Oqu(e)}}function x(a,g){if(1&a&&(t.TgZ(0,"ion-grid",9)(1,"ion-row",10)(2,"ion-col",11)(3,"ion-card",12)(4,"ion-card-header",12)(5,"ion-card-title"),t._uU(6),t.qZA()()()()(),t.TgZ(7,"ion-row",10),t.YNc(8,P,5,2,"ion-col",13),t.qZA()()),2&a){const e=t.oxw();t.xp6(6),t.Oqu(e.pregunta.preguntaEnunciado),t.xp6(2),t.Q6J("ngForOf",e.pregunta.respuestas)}}function Z(a,g){if(1&a&&(t.TgZ(0,"div"),t._UZ(1,"app-abrir-modal-fin",17),t.qZA()),2&a){const e=t.oxw();t.xp6(),t.s9C("resultado",e.resultado)}}const z=[{path:"",component:(()=>{class a{constructor(e,i,o,n,c){this.trivialSvc=e,this.toastController=i,this.loadingCtrl=o,this.datePipe=n,this.auth=c,this.tiradas=[],this.pregunta={},this.colorCategoria="",this.abrirModal=!1,this.resultado="ganado",this.uid=""}ngOnInit(){}ionViewWillEnter(){this.uid=this.auth.getUid(),this.cargardatos()}obtenerDia(){return(new Date).getDay().toString()}cargardatos(){this.showLoading(),this.trivialSvc.getPreguntas(this.obtenerDia()).subscribe({next:e=>{var i=e;this.loadingCtrl.dismiss(),this.obtenerJugadas(i)},error:e=>{}})}obtenerJugadas(e){var i=this;return(0,d.Z)(function*(){const o=i.datePipe.transform(new Date,"dd/MM/yyyy")?.replace(/\//g,"");i.trivialSvc.getJugada(i.uid,o).subscribe(n=>{console.log(n),i.tiradas=n,i.tiradas.length>=e.length?i.abrirFinDelJuego():(i.pregunta=e[i.tiradas.length],i.asignarColor(i.pregunta.categoria))})})()}responder(e){var i=this.tiradas.length,o="",n=this.pregunta.respuestas[this.pregunta.indiceRespuesta];e==n?(o="Has acertadoo canalla!!",this.addTirada(e,i)):typeof n>"u"?o="Suertee hoy bro!!!":(o=`Mala suerte amigo, era ${n}`,this.addTirada(e,i)),this.mensajeToUser(o)}asignarColor(e){switch(e){case"geografia":this.colorCategoria="warning";break;case"ciencia":this.colorCategoria="success";break;case"cine":this.colorCategoria="danger";break;case"historia":this.colorCategoria="secondary";break;default:this.colorCategoria="defaoultColor"}}mensajeToUser(e){var i=this;return(0,d.Z)(function*(){yield(yield i.toastController.create({message:e,duration:1500,position:"middle"})).present()})()}showLoading(){var e=this;return(0,d.Z)(function*(){const i=yield e.loadingCtrl.create({message:"Las preguntas de hoy son..."});i.present(),setTimeout(()=>{i.dismiss()},2e3)})()}abrirFinDelJuego(){if(this.abrirModal)this.abrirModal=!1;else{for(var e=0,i=0;i<this.tiradas.length;i++)this.tiradas[i].esCorrecta&&e++;e>this.tiradas.length/2?(this.abrirModal=!0,this.resultado="ganado"):(this.abrirModal=!0,this.resultado="perdido")}}addTirada(e,i){var o=this;return(0,d.Z)(function*(){console.log("uid:",o.uid);const c={idJugador:o.uid,idPregunta:i,respuesta:e,esCorrecta:e==o.pregunta.respuestas[o.pregunta.indiceRespuesta]};console.log(c),o.trivialSvc.addTirada(c).then(F=>{console.log("response:",F)})})()}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(m),t.Y36(s.yF),t.Y36(s.HT),t.Y36(l.uU),t.Y36(v.e))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-trivial"]],decls:11,vars:3,consts:[[3,"fullscreen"],["id","main-content",1,"ion-page"],[1,"marcador"],["name","color-palette-outline","size","large","color","primary",1,"icon-trivial"],["name","game-controller-outline","size","large","color","secondary",1,"icon-trivial"],["name","earth-outline","size","large","color","danger",1,"icon-trivial"],["name","football-outline","size","large",1,"icon-trivial"],["class","ion-align-self-center",4,"ngIf"],[4,"ngIf"],[1,"ion-align-self-center"],[1,"ion-align-items-center"],["size","12",1,"ion-text-center"],["color","light"],["size","6","class","ion-text-center","size-lg","6","size-md","6","size-sm","12","size","12",4,"ngFor","ngForOf"],["size","6","size-lg","6","size-md","6","size-sm","12","size","12",1,"ion-text-center"],[3,"color"],[3,"click"],[3,"resultado"]],template:function(i,o){1&i&&(t.TgZ(0,"ion-content",0),t._UZ(1,"app-mimenu"),t.TgZ(2,"ion-content",1),t._UZ(3,"app-miheader"),t.TgZ(4,"div",2),t._UZ(5,"ion-icon",3)(6,"ion-icon",4)(7,"ion-icon",5)(8,"ion-icon",6),t.qZA(),t.YNc(9,x,9,2,"ion-grid",7)(10,Z,2,1,"div",8),t.qZA()()),2&i&&(t.Q6J("fullscreen",!0),t.xp6(9),t.Q6J("ngIf",null!=o.pregunta.respuestas),t.xp6(),t.Q6J("ngIf",o.abrirModal))},dependencies:[l.sg,l.O5,s.PM,s.Zi,s.Dq,s.wI,s.W2,s.jY,s.gu,s.Nd,C.S,T.p,y.g],styles:[".header-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding-right:20px}.icon-trivial[_ngcontent-%COMP%]{margin:.5em}.marcador[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;margin:1em auto auto;border:.2em solid var(--ion-color-light);background-color:#3c3c3c0d;border-radius:1em;box-shadow:.25em .25em .4em #00000040}"]})}return a})()}];let b=(()=>{class a{static#t=this.\u0275fac=function(i){return new(i||a)};static#e=this.\u0275mod=t.oAB({type:a});static#i=this.\u0275inj=t.cJS({imports:[h.Bz.forChild(z),h.Bz]})}return a})();var J=r(822);let M=(()=>{class a{static#t=this.\u0275fac=function(i){return new(i||a)};static#e=this.\u0275mod=t.oAB({type:a});static#i=this.\u0275inj=t.cJS({imports:[l.ez,f.u5,s.Pc,b,J.K]})}return a})()}}]);